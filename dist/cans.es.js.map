{"version":3,"file":"cans.es.js","sources":["../src/cansf.js","../src/letter-spacing.js","../src/index.js"],"sourcesContent":["// canvas 静态方法\nconst px2Num = function (val) {\n  return ~~val.replace(/([\\d]+)px/, '$1')\n}\nconst percent2Num = function (v) {\n  return ~~v.replace('%', '') / 100\n}\n\nclass Cansf {\n  constructor (canvas) {\n    this.canvas = canvas || document.createElement('canvas')\n    this.ctx = this.canvas.getContext('2d')\n    this.cache = {}\n    this.drawImage = async (source, x, y, w, h, props = {}) => {\n      let { border, shadow, borderRadius, callback } = props\n      let bw = 0\n      if (shadow) {\n        this.setShadow(shadow)\n      } else {\n        this.setShadow('0 0 0 transparent')\n      }\n      if (border) {\n        let [, borderWidth, borderStyle, borderColor] = border.match(/([\\d]+(px)?)\\s+(solid|dashed)\\s+([#\\w\\d]+)/)\n        this.ctx.strokeStyle = borderColor\n        bw = px2Num(borderWidth)\n        this.ctx.lineWidth = bw\n        borderStyle === 'dashed' && this.ctx.setLineDash([2, 2])\n      }\n      let img = await this.getCache(source)\n      if (borderRadius) {\n        let canvas = this.imageRadiusClip(img, borderRadius)\n        this.ctx.drawImage(canvas, x, y, w, h)\n        border && this.borderRadiusClip(x, y, w, h , borderRadius)\n      } else{\n        this.ctx.drawImage(img, x, y, w, h)\n        bw && this.ctx.strokeRect(x - bw / 2, y - bw / 2, w + bw, h + bw)\n      }\n      callback && await callback(this)\n    }\n    this.drawLine = async (sx, sy, ex, ey, w, color, style, shadow, callback) => {\n      if (shadow) {\n        this.setShadow(shadow)\n      } else {\n        this.setShadow('0 0 0 transparent')\n      }\n      style === 'dashed' && this.ctx.setLineDash([2, 2])\n      this.ctx.beginPath()\n      this.ctx.moveTo(sx,sy)\n      this.ctx.lineWidth = w\n      this.ctx.lineTo(ex, ey)\n      this.ctx.strokeStyle = color\n      this.ctx.stroke()\n      callback && await callback(this)\n    }\n    this.drawText = async (text, x, y, props = {}) => {\n      let { color = '#000', fontSize = '10px', fontWeight = '', fontStyle = '', letterSpacing = '',\n       width, textAlign = 'left', hasBreak = false, lineHeight, shadow, callback} = props\n      if (shadow) {\n        this.setShadow(shadow)\n      } else {\n        this.setShadow('0 0 0 transparent')\n      }\n      this.ctx.font = `${fontStyle} ${fontWeight} ${fontSize} PingFangSC-Regular`\n      this.ctx.fillStyle = color\n      if (width) {\n        for (let i = 0; i < text.length; i++) {\n          if (this.ctx.measureText(text.slice(0, i + 1)).width > width) {\n            this.drawText(text.slice(0, i), x, y, {\n              ...props,\n              hasBreak: true\n            })\n            lineHeight = lineHeight ? px2Num(lineHeight) : px2Num(fontSize)\n            this.drawText(text.slice(i), x, y + lineHeight, props)\n            return\n          }\n        }\n      }\n      if (textAlign) {\n        this.ctx.textAlign = textAlign\n      }\n      if (width || hasBreak) {\n        switch (textAlign) {\n          case 'right':\n            x = x + width\n            break\n          case 'center':\n            x = (x + width) / 2\n            break\n        }\n      }\n      letterSpacing\n      ? this.ctx.letterSpacingText(text, x, y + ~~fontSize.replace(/([\\d]+)px/, '$1'), ~~px2Num(letterSpacing))\n      : this.ctx.fillText(text, x, y + ~~fontSize.replace(/([\\d]+)px/, '$1'))\n      callback && await callback(this, this.ctx.measureText(text))\n\n    }\n    this.reset = () => {\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n    }\n  }\n  async loadImg (src) {\n    return new Promise((resolve, reject) => {\n      let img = new Image()\n      if (!this.isBase64(src) && !this.isSomeHost(src)) {\n        img.crossOrigin = 'Anonymous'\n      }\n      img.src = src\n      img.addEventListener('load', loadEvt)\n      img.addEventListener('error', errorEvt)\n      function loadEvt () {\n        removeEvt()\n        return resolve(img)\n      }\n      function errorEvt() {\n        console.error('loadImg 图片加载失败: ' + src)\n        removeEvt()\n        return resolve()\n      }\n      function removeEvt () {\n        img.removeEventListener('load', loadEvt)\n        img.removeEventListener('error', errorEvt)\n      }\n    })\n  }\n  async getCache (source) {\n    if (typeof source === 'string') {\n      let key = this.isBase64(source) ? source.slice(-18) : source\n      if (!Object.hasOwnProperty(this.cache, key)) {\n        let img = await this.loadImg(source)\n        if (img) {\n          this.cache[key] = img\n        }\n      }\n      return this.cache[key] || null\n    } else {\n      return source\n    }\n    \n  }\n  isBase64 (src) {\n    return /^data:image\\/jpg;base64,/.test(src)\n  }\n  isSomeHost (src) {\n    let result = src.match(/^https?:\\/\\/[^\\/\\?#:]+/)\n    if (result && result[0] === window.location.hostname) {\n      return true\n    } else {\n      return false\n    }\n  }\n  imageRadiusClip (imgObj, r) {\n    let canvas = document.createElement('canvas')\n    let w = imgObj.width\n    let h = imgObj.height\n    canvas.width = w\n    canvas.height = h\n    let ctx = canvas.getContext('2d')\n    let pattern = ctx.createPattern(imgObj, 'no-repeat')\n    let min_size = Math.min(w, h)\n    let x = 0\n    let y = 0\n    r = min_size * percent2Num(r)\n    if (r > min_size / 2) r = min_size / 2\n    // 开始绘制\n    ctx.beginPath()\n    ctx.moveTo(x + r, y)\n    ctx.arcTo(x + w, y, x + w, y + h, r)\n    ctx.arcTo(x + w, y + h, x, y + h, r)\n    ctx.arcTo(x, y + h, x, y, r)\n    ctx.arcTo(x, y, x + w, y, r)\n    ctx.closePath()\n    ctx.fillStyle = pattern\n    ctx.fill()\n    return canvas\n  }\n  borderRadiusClip (x, y, w, h, r) {\n    let min_size = Math.min(w, h)\n    r = min_size * percent2Num(r)\n    this.ctx.beginPath()\n    this.ctx.moveTo(x + r, y)\n    this.ctx.arcTo(x + w, y, x + w, y + h, r)\n    this.ctx.arcTo(x + w, y + h, x, y + h, r)\n    this.ctx.arcTo(x, y + h, x, y, r)\n    this.ctx.arcTo(x, y, x + w, y, r)\n    this.ctx.closePath()\n    this.ctx.stroke()\n  }\n  setShadow (shadow) {\n    let [,shadowOffsetX, shadowOffsetY, shadowBlur, shadowColor]  = (shadow || {}).match(/([\\d]+)[\\s]+([\\d]+)[\\s]+([\\d]+)[\\s]+([rgba#()\\d,\\.\\s\\w]+)/)\n    this.ctx.shadowOffsetX = shadowOffsetX\n    this.ctx.shadowOffsetY = shadowOffsetY\n    this.ctx.shadowBlur = shadowBlur\n    this.ctx.shadowColor = shadowColor\n  }\n  output (tiny) {\n    if (!tiny) {\n      return this.canvas.toDataURL()\n    } else {\n      return this.canvas.toDataURL('image/jpeg', tiny)\n    }\n  }\n}\nexport default Cansf","/**\n* @author zhangxinxu(.com)\n* @licence MIT\n* @description http://www.zhangxinxu.com/wordpress/?p=7362\n*/\nCanvasRenderingContext2D.prototype.letterSpacingText = function (text, x, y, letterSpacing) {\n  var context = this;\n  var canvas = context.canvas;\n  \n  if (!letterSpacing && canvas) {\n      letterSpacing = parseFloat(window.getComputedStyle(canvas).letterSpacing);\n  }\n  if (!letterSpacing) {\n      return this.fillText(text, x, y);\n  }\n  \n  var arrText = text.split('');\n  var align = context.textAlign || 'left';\n  \n  // 这里仅考虑水平排列\n  var originWidth = context.measureText(text).width;\n  // 应用letterSpacing占据宽度\n  var actualWidth = originWidth + letterSpacing * (arrText.length - 1);\n  // 根据水平对齐方式确定第一个字符的坐标\n  if (align == 'center') {\n      x = x - actualWidth / 2;\n  } else if (align == 'right') {\n      x = x - actualWidth;\n  }\n  \n  // 临时修改为文本左对齐\n  context.textAlign = 'left';\n  // 开始逐字绘制\n  arrText.forEach(function (letter) {\n      var letterWidth = context.measureText(letter).width;\n      context.fillText(letter, x, y);\n      // 确定下一个字符的横坐标\n      x = x + letterWidth + letterSpacing;\n  });\n  // 对齐方式还原\n  context.textAlign = align;\n};","import Cansf from './cansf'\nimport './letter-spacing'\nconst Cans = class Cans extends Cansf{\n  constructor (canvas) {\n    super(canvas)\n    this.render = async (config) => {\n      this.setCanvas(config)\n      await this.resolveImages(config.images)\n      await this.resolveTexts(config.texts)\n      await this.resolveLines(config.lines)\n      return this\n    }\n  }\n  setCanvas ({background, width, height}) {\n    width && (this.canvas.width = width)\n    height && (this.canvas.height = height)\n    this.ctx.fillStyle = background\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height)\n  }\n  async resolveLines (lines = []) {\n    for (let i = 0; i < lines.length; i++) {\n      let {sx, sy, ex, ey, lineWidth, color, style, shadow, callback} = lines[i]\n      await this.drawLine(sx, sy, ex, ey, lineWidth, color, style, shadow, callback)\n    }\n  }\n  async resolveTexts (texts = []) {\n    for (let i = 0; i < texts.length; i++) {\n      let { text, x, y, ...arg } = texts[i]\n      await this.drawText(text, x, y, arg)\n    }\n  }\n  async resolveImages (images = []) {\n    let res = await Promise.all(images.map(v => this.getCache(v.source)))\n    for (let i = 0; i < res.length; i++) {\n      let img = res[i]\n      if (!img) {\n        console.error('图片加载失败 无法渲染: ' + images[i].source)\n        break\n      }\n      const {x, y, width, height, border, shadow, borderRadius, callback} = images[i]\n      await this.drawImage(\n        img,\n        x,\n        y,\n        width,\n        height,\n        {\n          border,\n          shadow,\n          borderRadius,\n          callback\n        }\n      )\n    }\n  }\n}\n\nexport default Cans"],"names":["px2Num","val","replace","percent2Num","v","Cansf","canvas","document","createElement","ctx","getContext","cache","drawImage","source","x","y","w","h","props","border","shadow","borderRadius","callback","bw","setShadow","match","borderWidth","borderStyle","borderColor","strokeStyle","lineWidth","setLineDash","getCache","img","imageRadiusClip","borderRadiusClip","strokeRect","drawLine","sx","sy","ex","ey","color","style","beginPath","moveTo","lineTo","stroke","drawText","text","fontSize","fontWeight","fontStyle","letterSpacing","width","textAlign","hasBreak","lineHeight","font","fillStyle","i","length","measureText","slice","letterSpacingText","fillText","reset","clearRect","height","src","Promise","resolve","reject","Image","isBase64","isSomeHost","crossOrigin","addEventListener","loadEvt","errorEvt","removeEvt","console","error","removeEventListener","key","Object","hasOwnProperty","loadImg","test","result","window","location","hostname","imgObj","r","pattern","createPattern","min_size","Math","min","arcTo","closePath","fill","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","tiny","toDataURL","CanvasRenderingContext2D","prototype","context","parseFloat","getComputedStyle","arrText","split","align","originWidth","actualWidth","forEach","letter","letterWidth","Cans","render","config","setCanvas","resolveImages","images","resolveTexts","texts","resolveLines","lines","background","fillRect","arg","all","map","res"],"mappings":"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"}